# ìœ ì±„ì› / ì›Œí¬ë¶ week02 - sql ì‘ì„±

â€» 2ì£¼ì°¨ ì›Œí¬ë¶ ìƒë‹¨ì— ì œì‹œëœ ERD ê¸°ì¤€ìœ¼ë¡œ ì¿¼ë¦¬ë¥¼ ì‘ì„±í•˜ì˜€ìŠµë‹ˆë‹¤.

- ERD ì´ë¯¸ì§€
    
    ![image.png](%EC%9C%A0%EC%B1%84%EC%9B%90%20%EC%9B%8C%ED%81%AC%EB%B6%81%20week02%20-%20sql%20%EC%9E%91%EC%84%B1%20279b57f4596b8117b221f7f7450af6e8/image.png)
    

## 1. ë‚´ê°€ ì§„í–‰ì¤‘, ì§„í–‰ ì™„ë£Œí•œ ë¯¸ì…˜ ëª¨ì•„ì„œ ë³´ëŠ” ì¿¼ë¦¬(í˜ì´ì§• í¬í•¨)

- ë¯¸ì…˜ ì´ë¯¸ì§€
    
    ![image.png](%EC%9C%A0%EC%B1%84%EC%9B%90%20%EC%9B%8C%ED%81%AC%EB%B6%81%20week02%20-%20sql%20%EC%9E%91%EC%84%B1%20279b57f4596b8117b221f7f7450af6e8/image%201.png)
    

ì½”ë“œë¥¼ ì¤„ì´ê¸° ë³´ë‹¤ëŠ” ì§ê´€ì ìœ¼ë¡œ ë³´ê¸° ìœ„í•´ aliasëŠ” ë”°ë¡œ ì‚¬ìš©í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤ 

```sql
SELECT [store.name](http://store.name/), mission.mission_spec, member_mission.status, [member.name](http://member.name/)
FROM member
JOIN member_mission 
	ON [member.id](http://member.id/) = member_mission.member_id
JOIN mission 
	ON member_mission.mission_id = [mission.id](http://mission.id/)
JOIN store 
	ON mission.store_id = [store.id](http://store.id/)
WHERE member_mission.status = 'ì§„í–‰ì¤‘' AND [member.name](http://member.name/) = 'ì½”ì±„'
limit {num} offset {pagenum-1} * {num};
```

**ì‹¤ì œë¡œëŠ” member.nameë³´ë‹¤ member.idë‚˜ usernameìœ¼ë¡œ ì°¾ì•„ì•¼ í•¨ ! (ì´ë¦„ ì¤‘ë³µ ë¬¸ì œ)**

- ì´í•´ë¥¼ ë•ê¸° ìœ„í•œ ì‹¤ìŠµ img
    
    ![image.png](%EC%9C%A0%EC%B1%84%EC%9B%90%20%EC%9B%8C%ED%81%AC%EB%B6%81%20week02%20-%20sql%20%EC%9E%91%EC%84%B1%20279b57f4596b8117b221f7f7450af6e8/52bae62e-6ef7-4f10-9fb4-29ad8c7c06cf.png)
    
    ![** íŒ€ì›ë“¤ ë‹‰ë„¤ì„ ì¢€ ë¹Œë ¸ìŠµë‹ˆë‹¤ ğŸ˜Š **](%EC%9C%A0%EC%B1%84%EC%9B%90%20%EC%9B%8C%ED%81%AC%EB%B6%81%20week02%20-%20sql%20%EC%9E%91%EC%84%B1%20279b57f4596b8117b221f7f7450af6e8/image%202.png)
    
    ** íŒ€ì›ë“¤ ë‹‰ë„¤ì„ ì¢€ ë¹Œë ¸ìŠµë‹ˆë‹¤ ğŸ˜Š **
    
- ì„œë¸Œì¿¼ë¦¬ ver. (but, êµ³ì´â€¦)
    
    ```java
    SELECT store.name, mission.mission_spec, member_mission.status, [member.name](http://mem.name/) 
    FROM member_mission
    JOIN mission ON member_mission.mission_id = mission[.id](http://m.id/)
    JOIN store s ON mission.store_id = [s.id](http://s.id/)
    JOIN member ON member_mission.member_id = member[.id](http://mem.id/)
    WHERE member_mission.status = 'ì§„í–‰ì¤‘'
    AND member_mission.member_id = (
    SELECT id FROM member WHERE name = 'ì½”ì±„'
    );
    ```
    
- ì»¤ì„œ í˜ì´ì§€ ver. (member_mission_idë¥¼ ê¸°ì¤€ìœ¼ë¡œ í•¨, ì¤‘ë³µë  ì¼ ì—†ê¸° ë•Œë¬¸ì— ë”°ë¡œ cursor_valueëŠ” ìƒì„±í•˜ì§€ ì•ŠìŒ)
    
    ```sql
    SELECT store.name, mission.mission_spec, member_mission.status, member.name
    FROM member
    JOIN member_mission 
    	ON member.id = member_mission.member_id
    JOIN mission 
    	ON member_mission.mission_id = mission.id
    JOIN store 
    	ON mission.store_id = store.id
    WHERE 
        member_mission.status = 'ì§„í–‰ì¤‘'
        AND member.name = 'ì½”ì±„'
    ORDER BY 
        member_mission.id DESC
    LIMIT {num};
    //ì²«ë²ˆì§¸ í˜ì´ì§€
    ```
    
    ```sql
    //ì´í›„ í˜ì´ì§€
    SELECT store.name, mission.mission_spec, member_mission.status, member.name
    FROM member
    JOIN member_mission 
    	ON member.id = member_mission.member_id
    JOIN mission 
    	ON member_mission.mission_id = mission.id
    JOIN store 
    	ON mission.store_id = store.id
    WHERE 
        member_mission.status = 'ì§„í–‰ì¤‘'
        AND member.name = 'ì½”ì±„'
        AND member_mission.id < {cursor_id}
    ORDER BY 
        member_mission.id DESC
    LIMIT {num};
    // cursor_idëŠ” í´ë¼ì´ì–¸íŠ¸ì¸¡ì—ì„œ ë§ˆì§€ë§‰ ì¡°íšŒë°ì´í„°ì—ì„œ
    // ë‹¤ìŒ í˜ì´ì§€ ìš”ì²­í•  ë•Œ ì„œë²„ì— ì „ë‹¬í•˜ëŠ” ê°’!!!!!!!!!!!!!!
    ```
    

## 2. ë¦¬ë·° ì‘ì„± ì¿¼ë¦¬

- ë¯¸ì…˜ ì´ë¯¸ì§€
    
    ![image.png](%EC%9C%A0%EC%B1%84%EC%9B%90%20%EC%9B%8C%ED%81%AC%EB%B6%81%20week02%20-%20sql%20%EC%9E%91%EC%84%B1%20279b57f4596b8117b221f7f7450af6e8/image%203.png)
    

```java
insert into review (member_id, store_id, body, score) 
values (memberId, storeId,  â€˜{ë¦¬ë·°ë‚´ìš©}â€™, â€˜{â­â­â­â­}â€™);
```

## 3. í™ˆí™”ë©´ ì¿¼ë¦¬(í˜„ì¬ ì„ íƒ ëœ ì§€ì—­ì—ì„œ ë„ì „ì´ ê°€ëŠ¥í•œ ë¯¸ì…˜ ëª©ë¡, í˜ì´ì§• í¬í•¨)

- ë¯¸ì…˜ ì´ë¯¸ì§€
    
    ![image.png](%EC%9C%A0%EC%B1%84%EC%9B%90%20%EC%9B%8C%ED%81%AC%EB%B6%81%20week02%20-%20sql%20%EC%9E%91%EC%84%B1%20279b57f4596b8117b221f7f7450af6e8/image%204.png)
    

** ~~í˜„ì¬ ì‚¬ìš©ì ìœ„ì¹˜~~ê°€ ì•„ë‹Œ â€œì„ íƒëœâ€ ì§€ì—­ì„ ê¸°ì¤€ìœ¼ë¡œ í•œë‹¤ê³  í–ˆìœ¼ë‹ˆ, ì§€ì—­ì´ ì„ íƒë˜ì–´ ìˆë‹¤ê³  ê°€ì •

â†’ ë§Œì•½ ì‚¬ìš©ì ìœ„ì¹˜ ê¸°ë°˜ìœ¼ë¡œ í•˜ê³  ì‹¶ë‹¤ë©´ member ê¹Œì§€ joiní•˜ì—¬ addressì™€ region ë¹„êµ ë¡œì§ ìˆ˜í–‰

1. ê°•ë‚¨ë™ ê°•ë‚¨ëŒ€ë¡œ 164 â†’ likeì—°ì‚°ìë¥¼ ì´ìš©
2. ë³„ë„ì˜ ë§¤í•‘ í…Œì´ë¸” ìƒì„±
3. ì‹¤ì‹œê°„ ìœ„ì¹˜ ê°™ì€ ê²½ìš° apiì—ì„œ ìœ„ë„, ê²½ë„ ë°›ì•„ì™€ì„œ ë²•ì •ë™ì½”ë“œë¡œ ì°¾ìŒ

ë¯¸ì…˜ ì§„í–‰ 7/10 countê°™ì€ ê²½ìš° ì§€ì—­ êµ¬ë¶„ ì—†ì´ â€˜userâ€™ê°€ ìˆ˜í–‰í•œ ë¯¸ì…˜ì„ ì „ë¶€ countí•œë‹¤ê³  ê°€ì •í•¨

```sql
SELECT 
    store.name, 
    mission.mission_spec, 
    mission.deadline, 
    member_mission.status, 
    region.name
FROM 
    region
JOIN 
    store ON region.id = store.region_id
JOIN 
    mission ON store.id = mission.store_id
JOIN 
    member_mission ON mission.mission_id = member_mission.mission_id
WHERE 
    region.name = 'ì•ˆì•”ë™'
ORDER BY 
    mission.deadline DESC
limit {num} offset {pagenum-1} * {num};

====================================================

SELECT COUNT(*)
FROM member_mission
where member_id = 1 and status = "ì§„í–‰ì™„ë£Œ" ;
```

## 4. ë§ˆì´í˜ì´ì§€ í™”ë©´ ì¿¼ë¦¬

- ë¯¸ì…˜ ì´ë¯¸ì§€
    
    ![image.png](%EC%9C%A0%EC%B1%84%EC%9B%90%20%EC%9B%8C%ED%81%AC%EB%B6%81%20week02%20-%20sql%20%EC%9E%91%EC%84%B1%20279b57f4596b8117b221f7f7450af6e8/image%205.png)
    

```sql
select member.name, member.email, member.phone, member.point
from member where id = 3
```

> ì»¤ì„œ ë°©ì‹ í˜ì´ì§€ë„¤ì´ì…˜ì— ëŒ€í•´ ë³´ì¶© ì •ë¦¬
> 

- LPADë¥¼ ì“°ëŠ” ì´ìœ  ?
    
    LPADëŠ” **SQL í•¨ìˆ˜** ì¤‘ í•˜ë‚˜ë¡œ, **ë¬¸ìì—´ ì™¼ìª½ì— íŠ¹ì • ë¬¸ìë¡œ ì±„ì›Œì„œ ì›í•˜ëŠ” ê¸¸ì´ë§Œí¼ ë§Œë“¤ì–´ì£¼ëŠ” í•¨ìˆ˜**
    

      ê¸¸ì´ê°€ ë‹¤ë¥´ë©´ ì´ëŸ° ë¬¸ì œê°€ ë°œìƒí•¨

      2 < 10 < 100    vs     '10' < '100' < '2'

ìˆ«ì ê°’ì„ ì¼ì •í•œ ê¸¸ì´ë¡œ ì™¼ìª½ì„ â€˜0â€™ìœ¼ë¡œ ì±„ì›Œì„œ

ì´ë ‡ê²Œ ê³ ì • ê¸¸ì´ ë¬¸ìì—´ë¡œ ë§Œë“¤ë©´

ë¬¸ìì—´ ì •ë ¬ë„ ìˆ«ì ì •ë ¬ ìˆœì„œì™€ ì¼ì¹˜!!